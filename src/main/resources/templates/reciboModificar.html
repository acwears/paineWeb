<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" 
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3">
      
	<!-- ***************************************************************************************************** -->
	<!-- ***************************************************************************************************** -->
	<!-- ***************************************************************************************************** -->
	<!-- ***************************************************************************************************** -->
	<!-- ************************************ COMIENZO contenido ********************************************* -->
		<!-- ********************************************************************************************** -->
		<!-- ******************************** COMIENZO recibo, fecha y datos cliente ********************** -->
		<div class="row">
			<div class="col-xs-12 col-sm-6 col-md-3 col-lg-2">
				<div class="input-group input-group-sm">
					<input th:value="${recibo.getId()}" type="text" class="form-control" id="IdRecibo" style="display: none;" readonly="readonly">
					<span class="input-group-addon" id="basic-addon15">Recibo #</span>
    				<input th:value="${recibo.numero}" type="miTabPanelText2" class="form-control" id="nroRecibo" name="nroRecibo" aria-describedby="basic-addon15">
    			</div>
    		</div>

    		<div class="col-xs-12 col-sm-6 col-md-3 col-lg-2">
    			<div class="input-group input-group-sm">
					<span class="input-group-addon" id="basic-addon16">Fecha</span>
					<input th:value="${#dates.format(recibo.fecha, 'dd/MM/yyyy')}" type="miTabPanelText2" class="form-control" id="fechaRecibo" aria-describedby="basic-addon16">
    			</div>
            </div>                                

    		<div class="col-xs-12 col-sm-6 col-md-2 col-lg-2 col-lg-offset-2">	    			
    			<input th:value="${recibo.getCliente().id}" type="text" class="form-control" id="clienteId" style="display: none;" readonly="readonly">
    			<div class="input-group input-group-sm">
					<span class="input-group-addon" id="basic-addon17">Cliente #</span>
    				<input th:value="${recibo.getCliente().numeroCliente}" type="miTabPanelText" class="form-control" id="clienteNro" readonly="readonly" aria-describedby="basic-addon17">
    			</div>
    		</div>

			<div class="col-xs-12 col-sm-6 col-md-4 col-lg-4">
				<div class="input-group input-group-sm">
					<span class="input-group-addon" id="basic-addon18">Nombre</span>
    				<input th:value="${recibo.getCliente().nombre}" type="miTabPanelText" class="form-control" id="clienteNombre" readonly="readonly" aria-describedby="basic-addon18"></input>
    				<span class="input-group-addon" id="basic-addon18">><button class="btn btn-link" data-toggle="modal" data-target="#modal_cliente" id="mostrar_mdl_cliente"></button></span>
    				<!--<span class="input-group-addon glyphicon glyphicon-search" aria-hidden="true" id="basic-addon18">+<button class="btn btn-link" data-toggle="modal" data-target="#modal_cliente" id="mostrar_mdl_cliente"></button></span>-->
    			</div>
    		</div>

			<!-- ***********************************************************************************-->
			<!-- ***********************************************************************************-->
			<!-- ************************ COMIENZO VENTANA MODAL CLIENTE ***************************-->
			<div class="modal fade" id="modal_cliente" tabindex="-1"  role="dialog"  aria-labelledby="myModalLabel" aria-hidden="true">
				<div class="modal-dialog">
					<div class="modal-content">
					 	<div class="modal-header">
					    	<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
					    	<h4 class="modal-title"><font color = "green">Seleccione al cliente</font></h4>
					  	</div>

						<div class="modal-body">			        
							
							<table class="display" cellspacing="0" width="100%" id="idTableSelectCte1">
							    <thead>
							        <tr>
							        	<th style="display: none;"></th>
							            <th style="font-weight:bold;">Cliente nro.</font></th>
							            <th style="font-weight:bold;">Nombre</font></th>
							        </tr>
							    </thead>
							    
								<tbody>
									<tr th:each="clienteVar : ${clientes}">
									    <td th:text="${clienteVar.id}" style="display: none;"></td>
										<td th:text="${clienteVar.numeroCliente}"></td>
										<td th:text="${clienteVar.nombre}"></td>
									</tr>
							    </tbody>
							</table>
						</div>

					  	<div class="modal-footer">
					    	<button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>					    	
					  	</div>
					</div><!-- *** FIN modal-content ***-->
				</div><!-- *** FIN modal-dialog ***-->
			</div><!-- ****** FIN VENTANA MODAL CLIENTE ****** -->   			
		</div><!-- END recibo, fecha y datos cliente -->

		<br>
		<br>
		<br>
		<!-- *************************************************************************************************-->
		<!-- *************************************************************************************************-->
		<!-- ******************************** COMIENZO datos FACTURA y TIPO DE PAGO ***************************-->
		
		<div class="row">			
			<div class="col-xs-12 col-sm-12 col-md-12 col-lg-4">
				<div class="panel panel-default">   
				  	<table class="table table-bordered" id="tblFactura">
							<tr class="success">
					            <td width="70%" style="font-weight:bold;"><font color = "#000000">Factura nro.</font></td>
					            <td width="25%" style="font-weight:bold;"><font color = "#000000">Fecha</font></td>
					            <td width="35%" style="font-weight:bold;"><font color = "#000000">Monto</font></td>
					            <td width="35%" style="font-weight:bold; display: none;"><font color = "#000000">idHidden</font></td>
					        </tr>
				        	<tr th:each="facturaVar : ${recibo.getFacturas()}">
				        	
								<td th:text="${facturaVar.numero}"></td>
								<td th:text="${#dates.format(facturaVar.fecha, 'dd/MM/yyyy')}"></td>
								<td th:text="${facturaVar.monto}" class="montoFac"></td>
								<td class="idParaHidden" style="display: none;" th:text="'fac_' + ${facturaVar.id}"></td>
								<td><button type="button" class="btn btn-success" aria-label="Left Align" onclick="editarMontoFactura(this)"/></button></td>
								<td><button type="button" class="btn btn-danger" aria-label="Left Align" onclick="eliminarHidden(this)"/></button></td>							
							</tr>
					        
					     <!--   <tr style="visibility:hidden; height: 0px;">
					        </tr> -->
					</table>
				</div>

				<div class="input-group input-group-sm" id="inGrTotalFacturas">
					<span class="input-group-addon" id="basic-addon19">Total facturas</span>
					<input th:value="${recibo.importeSumaFacturas}" type="miTabPanelText2" class="form-control" id="facturasMontoTotal" aria-describedby="basic-addon18">
					<span class="input-group-addon" id="basic-addon18">><button class="btn btn-link" data-toggle="modal" data-target="#modal_factura" id="mostrar_mdl_factura"></button></span>						
				</div>
			</div>

			<!-- ****** COMIENZO VENTANA MODAL FACTURA ****** -->
			
			<div class="modal fade" id="modal_factura" tabindex="-1"  role="dialog"  aria-labelledby="myModalLabel" aria-hidden="true">
				<!-- ESTE CONTENIDO LO COMPLETARA AJAX -->
			</div> <!-- ****** FIN VENTANA MODAL FACTURA ****** -->

			<!-- *********************************************************************************** -->
			<!-- *********************************************************************************** -->
			<!-- **************************************** COMIENZO TIPO DE PAGO ******************** -->

			<div class="col-xs-12 col-sm-12 col-md-12 col-lg-8">
				<div role="tabpanel" class="tab-pane"> <!-- comienzo tabpanel -->						
					<ul class="nav nav-tabs nav-justified navbar-inverse" role="tablist" id="nv1">
						<li role="presentation"><a href="#idEfectivo" aria-controls="idEfectivo" data-toggle="tab" role="tab">EFECTIVO</a></li>
						<li class="active" role="presentation"><a href="#idCheque" aria-controls="idCheque" data-toggle="tab" role="tab">CHEQUE</a></li>
						<li role="presentation"><a href="#idDeposito" aria-controls="idDeposito" data-toggle="tab" role="tab">DEPOSITO</a></li>
						<li role="presentation"><a href="#idRetencion" aria-controls="idRetencion" data-toggle="tab" role="tab">RETENCION</a></li>
						<li role="presentation"><a href="#idTabDescuento" aria-controls="idTabDescuento" data-toggle="tab" role="tab">DESCUENTO</a></li>
						<li role="presentation"><a href="#idTabObservaciones" aria-controls="idTabObservaciones" data-toggle="tab" role="tab">OBSERVACIONES</a></li>
					</ul>
					
					<div class="tab-content">

						<!-- **************************************************************************************** -->
						<!-- **************************************************************************************** -->
						<!-- **************************************************************************************** -->
					    <!-- *** COMIENZO EFECTIVO ****************************************************************** -->
					    
						<div role="tabpanel" class="tab-pane" id="idEfectivo">
							<div class="col-xs-12 col-sm-6 col-md-6 col-lg-4">
								<div class="input-group input-group-sm">
      								<span class="input-group-addon" id="basic-addon0">Importe</span>
      								<input th:value="${recibo.getTpEff().monto}" type="miTabPanelText" id="efectivoImporte" aria-describedby="basic-addon0">
   								</div>
   							</div>
						</div>						
						<!-- *** FIN EFECTIVO *** -->


						<!-- **************************************************************************************** -->
						<!-- **************************************************************************************** -->
						<!-- **************************************************************************************** -->
						<!-- ******************************************************************** COMIENZO CHEQUE *** -->

						<div role="tabpanel" class="active tab-pane" id="idCheque">
							<div  class="col-xs-12 col-sm-5 col-md-6 col-lg-4">
								<div class="input-group input-group-sm">
							        <span class="input-group-addon" id="basic-addon1">Banco</span>
									<select class="form-control" id="chequeBancoID" aria-describedby="basic-addon1">
							        	<option th:text="-------"></option>
							        	<option th:each="bancoVar : ${bancos}" th:text="${bancoVar.id} + ' - ' +  ${bancoVar.nombre}" th:value="${bancoVar.id}"></option>
							        </select>
								</div>
								
								<div class="input-group input-group-sm">
									<span class="input-group-addon" id="basic-addon2">Cheque #</span>
	  								<input type="miTabPanelText" id="chequeNroId" aria-describedby="basic-addon2">
								</div>

								<div class="input-group input-group-sm">
									<span class="input-group-addon" id="basic-addon3">Importe</span>
									<input type="miTabPanelText" id="chequeImporte" aria-describedby="basic-addon3">
								</div>

								<div class="input-group input-group-sm">
									<span class="input-group-addon" id="basic-addon4">CUIT</span>
									<input type="miTabPanelText" id="chequeCuitId" aria-describedby="basic-addon4">
								</div>

								<div class="input-group input-group-sm">
									<span class="input-group-addon" id="basic-addon5">Fecha dep.</span>
									<input type="miTabPanelText" id="chequeFechaId" aria-describedby="basic-addon5">								
								</div>
								<br>
									<button type="button" class="btn btn-default" id="chequeBtnAgregarID">Agregar al listado</button>
							</div>

							<div class="col-xs-12 col-sm-7 col-md-6 col-lg-8" id="idChequeListado">
								<!--<div class="panel panel-default" style="margin-left: 40px;">-->
								<div class="panel panel-default">
										<table class="table table-bordered" id="tableChequeId">
										        <tr class="success">
										            <th width="40%" style="font-weight:bold;"><font color = "#000000">Banco</font></th>
										            <th width="20%" style="font-weight:bold;"><font color = "#000000">Importe</font></th>
										            <th width="20%" style="font-weight:bold;"><font color = "#000000">Nro.</font></th>
										            <th width="20%" style="font-weight:bold;"><font color = "#000000">CUIT</font></th>
										            <th width="20%" style="font-weight:bold;"><font color = "#000000">Fecha</font></th>
										            <th width="20%" style="font-weight:bold; display: none;"><font color = "#000000">idHidden</font></th>
										        </tr>
										        
											    <tr th:each="chequeVar : ${recibo.getTpCheques()}">											    	
													<td th:text="${chequeVar.banco.id}"></td>
													<td class="montoCheque" th:text="${chequeVar.monto}"></td>
													<td th:text="${chequeVar.numero}"></td>
													<td th:text="${chequeVar.cuit}"></td>
													<td th:text="${#dates.format(chequeVar.fechaDeposito, 'dd/MM/yyyy')}"></td>
													<td class="idParaHidden" style="display: none;" th:text="'ch_' + ${chequeVar.id}"></td>
													<td><button type="button" class="btn btn-default" aria-label="Left Align" onclick="eliminarHidden(this)"/></button></td>
												</tr>									
										</table>																			
										<form action="#" th:action="@{/recibo/modificar}" th:object="${reciboDto}" method="post" id="reciboFormId">
												<!-- CREO EL HIDDEN DEL CHEQUE -->					        
											    <div th:each="chequeVar : ${recibo.getTpCheques()}">										    	
													<input type="hidden" name="chequeBanco" th:value="${chequeVar.banco.id}" th:attr="class='ch_' + ${chequeVar.id}" ></input>
													<input type="hidden" name="chequeImporte" th:value="${chequeVar.monto}" th:attr="class='ch_' + ${chequeVar.id}"></input>													
													<input type="hidden" name="chequeNro" th:value="${chequeVar.numero}" th:attr="class='ch_' + ${chequeVar.id}"></input>
													<input type="hidden" name="chequeCuit" th:value="${chequeVar.cuit}" th:attr="class='ch_' + ${chequeVar.id}"></input>
													<input type="hidden" name="chequeFechaDeposito" th:value="${#dates.format(chequeVar.fechaDeposito, 'dd/MM/yyyy')}" th:attr="class='ch_' + ${chequeVar.id}"></input>																									
												</div>
												
												<!-- CREO EL HIDDEN DEL DEPOSITO -->
												<div th:each="depositoVar : ${recibo.getTpDepositos()}">
													<input type="hidden" name="depositoBanco" th:value="${depositoVar.banco.id}" th:attr="class='dep_' + ${depositoVar.id}" ></input>
													<input type="hidden" name="depositoImporte" th:value="${depositoVar.monto}" th:attr="class='dep_' + ${depositoVar.id}" ></input>
													<input type="hidden" name="depositoFecha" th:value="${#dates.format(depositoVar.fecha, 'dd/MM/yyyy')}" th:attr="class='dep_' + ${depositoVar.id}" ></input>
												</div>
												
												<!-- CREO EL HIDDEN DEL DESCUENTO -->
												<div th:each="descuentoVar : ${recibo.getDescuentos()}">
													<input type="hidden" name="descuentoDescripcion" th:value="${descuentoVar.descripcion}" th:attr="class='des_' + ${descuentoVar.id}" ></input>
													<input type="hidden" name="descuentoPorcentaje" th:value="${descuentoVar.porcentaje}" th:attr="class='des_' + ${descuentoVar.id}" ></input>
												</div>
												
												<!-- CREO EL HIDDEN DE LAS FACTURA -->
												<div th:each="facturaVar : ${recibo.getFacturas()}">
													<input type="hidden" name="facturaNro" th:value="${facturaVar.numero}" th:attr="class='fac_' + ${facturaVar.id}" ></input>
													<input type="hidden" name="facturaFecha" th:value="${#dates.format(facturaVar.fecha, 'dd/MM/yyyy')}" th:attr="class='fac_' + ${facturaVar.id}" ></input>
													<input type="hidden" name="facturaMonto" th:value="${facturaVar.monto}" th:attr="class='fac_' + ${facturaVar.id}" ></input>
												</div>
												
												<!-- CREO EL HIDDEN DE LAS RETENCIONES -->
												<div th:each="retencionVar : ${recibo.getTpRetenciones()}">
													<input type="hidden" name="retencionTipoPago" th:value="${retencionVar.tipoPago}" th:attr="class='ret_' + ${retencionVar.id}" ></input>
													<input type="hidden" name="retencionNumero" th:value="${retencionVar.numero}" th:attr="class='ret_' + ${retencionVar.id}" ></input>
													<input type="hidden" name="retencionImporte" th:value="${retencionVar.monto}" th:attr="class='ret_' + ${retencionVar.id}" ></input>
													<input type="hidden" name="retencionSucursal" th:value="${retencionVar.sucursal}" th:attr="class='ret_' + ${retencionVar.id}" ></input>
													<input type="hidden" name="retencionYear" th:value="${retencionVar.anio}" th:attr="class='ret_' + ${retencionVar.id}" ></input>
												</div>
										</form>
								</div>
								<div class="input-group input-group-sm">
									<span class="input-group-addon" id="basic-addon36">Total cheques</span>
									<input th:value="${sumaMontoCheques}" type="miTabPanelText" class="form-control" id="chequeMontoTotalId" readonly="readonly" aria-describedby="basic-addon36">
								</div>
							</div>
						</div>   <!-- *** FIN CHEQUE *** -->

						
						
						
						<!-- ******************************************************************************************************* -->
						<!-- ******************************************************************************************************* -->
						<!-- ******************************************************************************************************* -->
						<!-- ******************************************************************************************************* -->
						<!-- ******************************************************************** COMIENZO DEPOSITO **************** -->

						<div role="tabpanel" class="tab-pane" id="idDeposito">
							<div class="col-xs-12 col-sm-5 col-md-5 col-lg-4">
								<div class="input-group input-group-sm">
									<span class="input-group-addon" id="basic-addon6">Banco</span>
									<select class="form-control" id="depositoBancoId" aria-describedby="basic-addon6">
										<option th:text="-------"></option>
										<option th:each="bancoVar : ${bancos}" th:text="${bancoVar.id} + ' - ' +  ${bancoVar.nombre}" th:value="${bancoVar.id}"></option>
							        </select>
								</div>

						        <div class="input-group input-group-sm">
									<span class="input-group-addon" id="basic-addon7">Importe</span>
									<input type="miTabPanelText" id="depositoImporteId" aria-describedby="basic-addon7">
								</div>

								<div class="input-group input-group-sm">
									<span class="input-group-addon" id="basic-addon8">Fecha dep.</span>
									<input type="miTabPanelText" id="depositoFechaId" aria-describedby="basic-addon8">
								</div>

								<br>
								<button type="button" class="btn btn-default" id="depositoBtnAgregarId">Agregar al listado</button>							
							</div>

							<div class="col-xs-12 col-sm-7 col-md-7 col-lg-7" id="idDepListado">
								<div class="panel panel-default">
									<table class="table table-bordered" id="tableDepositoID">
								        <tr class="success">
								            <th width="60%" style="font-weight:bold;"><font color = "#000000">Banco</font></th>
								            <th width="130%" style="font-weight:bold;"><font color = "#000000">Importe</font></th>
								            <th width="40%" style="font-weight:bold;"><font color = "#000000">Fecha</font></th>
								            <th width="40%" style="font-weight:bold; display: none;"><font color = "#000000">idHidden</font></th>
								        </tr>
								        								        
								       	<tr th:each="depositoVar : ${recibo.getTpDepositos()}">
											<td th:text="${depositoVar.banco.id}"></td>
											<td th:text="${depositoVar.monto}" class="montoDeposito"></td>
											<td th:text="${#dates.format(depositoVar.fecha, 'dd/MM/yyyy')}"></td>
											<td class="idParaHidden" style="display: none;" th:text="'dep_' + ${depositoVar.id}"></td>
											<td><button type="button" class="btn btn-default" aria-label="Left Align" onclick="eliminarHidden(this)"/></button></td>							
										</tr>									      
									</table>
								</div>

								<div class="input-group input-group-sm">
									<span class="input-group-addon" id="basic-addon37">Total depósitos</span>
									<input th:value="${sumaMontoDepositos}" type="miTabPanelTex" class="form-control" id="depositoMontoTotal" readonly="readonly" aria-describedby="basic-addon37">
								</div>
							</div>
						</div><!-- *** FIN DEPOSITO *** -->

						




						<!-- ******************************************************************************************************* -->
						<!-- ******************************************************************************************************* -->
						<!-- ******************************************************************************************************* -->
						<!-- ******************************************************************************************************* -->
						<!-- ******************************************************************** COMIENZO RETENCION *************** -->											
						
						<div role="tabpanel" class="tab-pane" id="idRetencion">
							<div class="col-xs-12 col-sm-5 col-md-5 col-lg-4">
								<div class="input-group input-group-sm">
									<span class="input-group-addon" id="basic-addon66">Tipo de pago</span>
									<select class="form-control" id="retencionTipoPago" aria-describedby="basic-addon66">
										<option>-------</option>
										<option>Retencion Ganancias</option>
										<option>Retencion Iva</option>
										<option>Retencion IIBB Capital</option>
										<option>Retencion IIBB Buenos Aire</option>
										<option>Retencion IIBB San Lui</option>
										<option>Retenicon IIBB Santa Fe</option>
							        </select>
								</div>
								
								<div class="input-group input-group-sm">
									<span class="input-group-addon" id="basic-addon9">Retención #</span>
									<input type="miTabPanelText" id="retencionNumero" aria-describedby="basic-addon9">
								</div>

								<div class="input-group input-group-sm">
									<span class="input-group-addon" id="basic-addon10">Importe</span>
									<input type="miTabPanelText" id="retencionImporte" aria-describedby="basic-addon10">
								</div>
							
								<div class="input-group input-group-sm">
									<span class="input-group-addon" id="basic-addon11">Sucursal</span>
									<input type="miTabPanelText" id="retencionSucursal" aria-describedby="basic-addon11">
								</div>

								<div class="input-group input-group-sm">
									<span class="input-group-addon" id="basic-addon12">Año</span>
									<input type="miTabPanelText" id="retencionYear" aria-describedby="basic-addon12">
								</div>
								
								<br>
								<button type="button" class="btn btn-default" id="retencionBtnAgregarId">Agregar al listado</button>
							</div>
							
							<div class="col-xs-12 col-sm-7 col-md-7 col-lg-7" id="idRetencionListado">
								<div class="panel panel-default">
									<table class="table table-bordered" id="tablaRetencionID">
									        <tr class="success">
									        	<th width="60%" style="font-weight:bold;"><font color = "#000000">Tipo de pago</font></th>
									            <th width="60%" style="font-weight:bold;"><font color = "#000000">Numero</font></th>
									            <th width="130%" style="font-weight:bold;"><font color = "#000000">Importe</font></th>
									            <th width="40%" style="font-weight:bold;"><font color = "#000000">Sucursal</font></th>
									            <th width="40%" style="font-weight:bold;"><font color = "#000000">Año</font></th>								
									            <th width="40%" style="font-weight:bold; display: none;"><font color = "#000000">idHidden</font></th>
									        </tr>
									        
									        <tr th:each="retencionVar : ${recibo.getTpRetenciones()}">
												<td th:text="${retencionVar.tipoPago}"></td>
												<td th:text="${retencionVar.numero}"></td>
												<td th:text="${retencionVar.monto}" class="montoRetencion"></td>
												<td th:text="${retencionVar.sucursal}"></td>
												<td th:text="${retencionVar.anio}"></td>
												<td class="idParaHidden" style="display: none;" th:text="'ret_' + ${retencionVar.id}"></td>
												<td><button type="button" class="btn btn-default" aria-label="Left Align" onclick="eliminarHidden(this)"/></button></td>							
											</tr>
									</table>
								</div>
								
								<div class="input-group input-group-sm">
									<span class="input-group-addon" id="basic-addon87">Total retenciones</span>
									<input th:value="${sumaMontoRetenciones}" type="miTabPanelTex" class="form-control" id="retencionMontoTotal" readonly="readonly" aria-describedby="basic-addon87">
								</div>
							</div>
						</div><!-- *** FIN RETENCION *** -->

						<!-- ******************************************************************************************************* -->
						<!-- ******************************************************************************************************* -->
						<!-- ******************************************************************************************************* -->
						<!-- ******************************************************************************************************* -->
						<!-- ******************************************************************** COMIENZO DESCUENTO *************** -->	
						<div role="tabpanel" class="tab-pane" id="idTabDescuento">
							<div class="col-xs-12 col-sm-12 col-md-12 col-lg-4">
				    			<div class="input-group input-group-sm">
				    				<span class="input-group-addon" id="basic-addon13">Descripción</span>
				    				<input type="miTabPanelText" id="descuentoDescripcionId" aria-describedby="basic-addon13">
				    			</div>

				    			<div class="input-group input-group-sm">
				    				<span class="input-group-addon" id="basic-addon14">Monto</span>
				    				<input type="miTabPanelText" id="descuentoPorcentajeId" aria-describedby="basic-addon14">
				    			</div>

				    			<div>
				    				<br>
									<button type="button" class="btn btn-default" id="descuentoBtnAgregarId">Agregar al listado</button>
								</div>
				    		</div>

							<div class="col-xs-12 col-sm-12 col-md-6 col-lg-7">
								<div class="panel panel-default">
									<table class="table table-bordered" id="descuentoTableId">
									        <tr class="success">
									        	<th width="200%" style="font-weight:bold;"><font color = "#000000">Descripción</font></th>
									            <th width="200%" style="font-weight:bold;"><font color = "#000000">Monto</font></th>
									            <th width="200%" style="font-weight:bold; display: none;"><font color = "#000000">idHidden</font></th>           
									        </tr>
									        <tr th:each="descuentoVar : ${recibo.getDescuentos()}">
									        	<td th:text="${descuentoVar.descripcion}"></td>
									        	<td class="porcentajeDescuento" th:text="${descuentoVar.porcentaje}"></td>
									        	<td class="idParaHidden" style="display: none;" th:text="'des_' + ${descuentoVar.id}"></td>
												<td><button type="button" class="btn btn-default" aria-label="Left Align" onclick="eliminarHidden(this)"/></button></td>
									        </tr>
									</table>														
								</div>

								<div class="input-group input-group-sm">
									<span class="input-group-addon" id="basic-addon38">Total descuento</span>
									<input th:value="${recibo.descuento}" type="miTabPanelText" class="form-control" id="importeTotalDescuento" readonly="readonly" value="0" aria-describedby="basic-addon38">
								</div>
							</div>		
						</div><!-- *** FIN DESCUENTO... *** -->


						<!-- **************************************************************************************** -->
						<!-- **************************************************************************************** -->
						<!-- **************************************************************************************** -->
					    <!-- *** COMIENZO OBSERVACIONES ************************************************************* -->
					    
						<div role="tabpanel" class="tab-pane" id="idTabObservaciones">
							<div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
								<div class="row">
	    							<textarea th:text="${recibo.observaciones}" class="form-control" rows="10" placeholder="Indique aqui las observaciones del recibo." id="idObservaciones"></textarea>
	    						</div>
   							</div>
						</div>						
						<!-- *** FIN OBSERVACIONES *** -->

					</div> <!-- *** END TAB CONTENT... *** -->

				</div> <!-- *** END TAB PANEL... *** -->

			</div> <!-- *** END TIPO DE PAGO - END DIV QUE ENVUELVE AL TAB PANEL *** -->

		</div> <!-- *********************************** END datos FACTURA Y TIPO DE PAGO **************************************** -->
			   <!-- ************************************************************************************************************* -->
			   <!-- ************************************************************************************************************* -->



		<!-- ******************************************************************************************************* -->
		<!-- ******************************************************************************************************* -->
		<!-- ******************************************************************************************************* -->
		<!-- ******************************************************************************************************* -->
		<!-- *************************************** COMIENZO RESUMEN Y BALANCE ************************************ -->
		<br>
		<br>
		
		<div class="row">					
			<div class="col-xs-12 col-sm-12 col-md-12 col-lg-4">						
				<div class="input-group input-group-sm">
					<span class="input-group-addon" id="basic-addon20">Recibo importe</span>
					<input th:value="${recibo.importeTotal}" type="miTabPanelText" readonly="readonly" id="montoTotalRecibo" aria-describedby="basic-addon20">
	    		</div>

	    		<div class="input-group input-group-sm">
	    			<span class="input-group-addon" id="basic-addon21">Balance</span>
					<input type="miTabPanelText" readonly="readonly" id="balance" aria-describedby="basic-addon21">						
	    		</div>

	    		<div class="row">
					<div class="col-xs-12 col-sm-6 col-md-3 col-lg-3">
						<input class="btn btn-primary btn-lg" type="button" value="Guardar recibo" id="idGuardarRecibo">								
	    			</div>
				</div>
			</div>					

			<div class="tab-pane col-xs-12 col-sm-12 col-md-12 col-lg-8" id="idResumen">
				<div class="panel panel-success">
					<div class="panel-heading">RESUMEN</div>
					<div class="panel-body" style="background-color: #2c3e50;">
						<div class="col-xs-12 col-sm-12 col-md-5 col-lg-4">
							<div class="input-group input-group-sm">
								<span class="input-group-addon" id="basic-addon30">Efectivo</span>
								<input th:value="${recibo.getTpEff().monto}" type="miTabPanelText" id="efectivoImporteRES" readonly="readonly" aria-describedby="basic-addon30">
							</div>

							<div class="input-group input-group-sm">
								<span class="input-group-addon" id="basic-addon31">Cheques</span>
								<input th:value="${sumaMontoCheques}" type="miTabPanelText" id="chequeMontoTotalIdRES" readonly="readonly" aria-describedby="basic-addon31">
							</div>
						</div>

						<div class="col-xs-12 col-sm-12 col-md-5 col-lg-4">
							<div class="input-group input-group-sm">
								<span class="input-group-addon" id="basic-addon32">Depósitos</span>
								<input th:value="${sumaMontoDepositos}" type="miTabPanelText" id="depositoMontoTotalRES" readonly="readonly" aria-describedby="basic-addon32">
							</div>

							<div class="input-group input-group-sm">
								<span class="input-group-addon" id="basic-addon32">Retención</span>
								<input th:value="${sumaMontoRetenciones}" type="miTabPanelText" id="retencionMontoTotalRES" readonly="readonly" aria-describedby="basic-addon33">
							</div>
						</div>
						<div class="col-xs-12 col-sm-12 col-md-5 col-lg-4">
							<div class="input-group input-group-sm">
								<span class="input-group-addon" id="basic-addon34">Descuento</span>
								<input th:value="${recibo.descuento}" type="miTabPanelText" id="importeTotalDescuentoRES" readonly="readonly" aria-describedby="basic-addon34">
							</div>
						</div>					
					</div>
				</div>						
			</div>			
		</div> <!-- *** END RESUMEN Y BALANCE *** -->


					<!-- *****************************************************************************************************-->
					<!-- *****************************************************************************************************-->
					<!-- ************************ COMIENZO VENTANA MODAL PARA EL MANEJO DE ERRORES ***************************-->
					<div class="modal fade" id="modalMensajes" tabindex="-1"  role="dialog"  aria-labelledby="myModalLabel" aria-hidden="true">
						<div class="modal-dialog">
							<div class="modal-content" style="background-color: #D8D8D8;">
							 	<div class="modal-header" style="background-color: #585858">
							    	<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
							    	<h4 class="modal-title"><font color = "white">Ruka Paine S.r.l</font></h4>
							  	</div>

								<div class="modal-body">				
									<div>
										<br>
										<br>
										<!-- <label for="exampleInputEmail1"><h5 id="textModal"></h5></label> -->
										<h5 id="textModal" style="color: #610B21"></h5>
										<br>
										<br>
									</div>
								</div>

								<div class="modal-footer" style="background-color: #848484">
								<button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
								</div>
							</div><!-- /.modal-content -->
						</div><!-- /.modal-dialog -->
					</div><!-- /.modal -->	
	    			<!-- ********************************************** FIN VENTANA MODAL ************************************* -->
	    		
	    		
<style> 
#mnuModif{color:white;} 
</style>    		

<script type="text/javascript">
	var errObject ='';
	var ajaxExecuted;
	
	$(document).ready(function(){	
		
		$("#successMessage").fadeOut(10000);
		$("#errorMessage").fadeOut(10000);
		calcularBalance();
		
		$('#fechaRecibo').datepicker({
			format: 'dd/mm/yyyy',
			//inline: true,
            //sideBySide: true
		});
		$('#chequeFechaId').datepicker({
			format: 'dd/mm/yyyy'
		});
		$('#depositoFechaId').datepicker({
			format: 'dd/mm/yyyy'
		});
		
		
		$("#mostrar_mdl_factura").click(function() {
			
			// Do not call ajax again if it already was called				
			if(ajaxExecuted) {
				$("#modal_factura").show();
				return;
			}
			
			var clienteNro = $("#clienteNro").val();
			
			$.ajax({
				url : '/listarCCByCustomer',
				data : 'clienteNro=' + clienteNro,
				type : 'GET',
				dataType : 'html',
				success : function(data) {
					$('#modal_factura').html(data);
					$("#modal_factura").modal();
		 			ajaxExecuted = true;
				},
				error : function() {
					// Aqui código cuando servidor retorna error
				}
			});
		});
		
		$("#facturaTblModal tr").click(function(){
			var facturaSumaImportes = 0;
			var tdArray = $(this).find("td");
			
			var idHiddenDate=new Date();
			var idHiddenDate2 = idHiddenDate.getTime().toString();			
			
			var facturaNro = tdArray[0].innerHTML; //"123A"; //$(this).text();
			var facturaFecha = tdArray[3].innerHTML;
			var facturaMonto = tdArray[5].innerHTML;
			
			var newRecord = '<tr><td>' + facturaNro + '</td>';
			newRecord = newRecord + '<td>' + facturaFecha + '</td>';
			newRecord = newRecord + '<td class="montoFac">' + facturaMonto + '</td>';
			newRecord = newRecord + '<td class="idParaHidden" style="display: none;">' + idHiddenDate2 + '</td>';
			newRecord = newRecord + '<td><button type="button" class="btn btn-default" aria-label="Left Align" onclick="eliminarHidden(this)"/></button></td></tr>';
			
			$('#tblFactura tr:last').after(newRecord);
		
 			crearHiddenB('facturaNro', facturaNro, idHiddenDate2);
 			crearHiddenB('facturaFecha', facturaFecha, idHiddenDate2);
 			crearHiddenB('facturaMonto', facturaMonto, idHiddenDate2);
 						
 			//sumo el monto de cada factura
 			sumarMontos("#facturasMontoTotal", facturaMonto);
 			calcularMontoTotalRecibo();
 			//calcularImporte_Descuento();
 			calcularBalance();
		});
		
		//BORRO LA FACTURA SELECCIONADA DE LA GRILLA
	/*	$("#tblFactura tr").dblclick(function(){
			var tdArray = $(this).find("td");
			var monto = tdArray[1].innerHTML;
			alert(monto);
			document.getElementById("tblFactura").deleteRow(1);
	    });*/
		
		$("#idTableSelectCte1").dataTable();
		
		$('#idTableSelectCte1').on( 'draw.dt', function () {
			$(this).find('tr').bind("click", function(){
				selectRow(this);
			});		  
		} );	  
	    
		$("#idTableSelectCte1 tr").click(function(){
			selectRow(this);
		});
	    
	/*	$("#idTableSelectCte1 tr").click(function(){
			var tdArray = $(this).find("td");

			var clienteId = tdArray[0].innerHTML;
			var clienteNumero = tdArray[1].innerHTML;
			var clienteNombre = tdArray[2].innerHTML;
			$("#modal_cliente").modal('toggle');
			
			$("#clienteNro").val(clienteNumero);
			$("#clienteNombre").val(clienteNombre);
			$("#clienteId").val(clienteId);
		}); */

	    
		$("#retencionBtnAgregarId").click(function() {
			var idHiddenDate = new Date();
			var idHiddenDate2 = idHiddenDate.getTime().toString();
			
			if(!validaIntegridad_Retencion()){return;}
			
			var retencionTipoPago = $('#retencionTipoPago').val();
			var retencionNumero = $('#retencionNumero').val();
			var retencionImporte = $('#retencionImporte').val();
			var retencionSucursal = $('#retencionSucursal').val();
			var retencionYear = $('#retencionYear').val();
			
			var newRecord = '<tr><td>' + $('#retencionTipoPago option:selected').text() + '</td>';
			newRecord = newRecord + '<td>' + retencionNumero + '</td>';
			newRecord = newRecord + '<td class="montoRetencion">' + retencionImporte + '</td>';
			newRecord = newRecord + '<td>' + retencionSucursal + '</td>';
			newRecord = newRecord + '<td>' + retencionYear + '</td>';
			newRecord = newRecord + '<td class="idParaHidden" style="display: none;">' + idHiddenDate2 + '</td>';
			newRecord = newRecord + '<td><button type="button" class="btn btn-default" aria-label="Left Align" onclick="eliminarHidden(this)"/></button></td></tr>';
			
			$('#tablaRetencionID tr:last').after(newRecord);
					
			crearHiddenB('retencionTipoPago', retencionTipoPago, idHiddenDate2);
			crearHiddenB('retencionNumero', retencionNumero, idHiddenDate2);
			crearHiddenB('retencionImporte', retencionImporte, idHiddenDate2);
			crearHiddenB('retencionSucursal', retencionSucursal, idHiddenDate2);
			crearHiddenB('retencionYear', retencionYear, idHiddenDate2);
			
			//sumo el monto de cada retencion agregada
 			sumarMontos("#retencionMontoTotal", retencionImporte);
 			calcularMontoTotalRecibo();
 			calcularBalance();
		});
	    
	    
		$("#depositoBtnAgregarId").click(function() {
			var idHiddenDate=new Date();
			var idHiddenDate2 = idHiddenDate.getTime().toString();
			
			if(!validaIntegridad_Deposito()){return;}
			
			var depositoBancoVar = $('#depositoBancoId').val();
			var depositoImporteVar = $('#depositoImporteId').val();
			var depositoFechaVar = $('#depositoFechaId').val();
			//class="idParaHidden"
			var newRecord = '<tr><td>' + $('#depositoBancoId option:selected').text() + '</td>';
			newRecord = newRecord + '<td class="montoDeposito">' + depositoImporteVar + '</td>';
			newRecord = newRecord + '<td>' + depositoFechaVar + '</td>';
			newRecord = newRecord + '<td class="idParaHidden" style="display: none;">' + idHiddenDate2 + '</td>';
			newRecord = newRecord + '<td><button type="button" class="btn btn-default" aria-label="Left Align" onclick="eliminarHidden(this)"/></button></td></tr>';
			//Adicionar row
			$('#tableDepositoID tr:last').after(newRecord);
			
			//creo hidden y lo adiciono al form
			
 			crearHiddenB('depositoBanco', depositoBancoVar, idHiddenDate2);
 			crearHiddenB('depositoImporte', depositoImporteVar, idHiddenDate2);
 			crearHiddenB('depositoFecha', depositoFechaVar, idHiddenDate2);
 			
 			//sumo el monto de cada cada deposito agregado
 			sumarMontos("#depositoMontoTotal", depositoImporteVar);
 			calcularMontoTotalRecibo();
 			calcularBalance();
		});
		
		$("#chequeBtnAgregarID").click(function() {
			var idHiddenDate=new Date();
			var idHiddenDate2 = idHiddenDate.getTime().toString();
			
			if(!validaIntegridad_DeCheque()){return;}
			
			var chequeNroIdVar = $('#chequeNroId').val();
			var chequeBancoIDVar = $('#chequeBancoID').val();
			var chequeImporteIdVar = $('#chequeImporte').val();
			var chequeCuitIdVar = $('#chequeCuitId').val();
			var chequeFechaIdVar = $('#chequeFechaId').val();
			
			var newRecord = '<tr><td>' + $('#chequeBancoID option:selected').text() + '</td>';
			newRecord = newRecord + '<td class="montoCheque">' + chequeImporteIdVar + '</td>';
			newRecord = newRecord + '<td>' + chequeNroIdVar + '</td>';
			newRecord = newRecord + '<td>' + chequeCuitIdVar + '</td>';
			newRecord = newRecord + '<td>' + chequeFechaIdVar + '</td>';
			newRecord = newRecord + '<td class="idParaHidden" style="display: none;">' + idHiddenDate2 + '</td>';
			newRecord = newRecord + '<td><button type="button" class="btn btn-default" aria-label="Left Align" onclick="eliminarHidden(this)"/></button></td></tr>';
			
			//Adicionar row
			$('#tableChequeId tr:last').after(newRecord);
			
			//creo hidden y lo adiciono al form
 			crearHiddenB('chequeNro', chequeNroIdVar, idHiddenDate2);
			crearHiddenB('chequeBanco', chequeBancoIDVar, idHiddenDate2);
			crearHiddenB('chequeImporte', chequeImporteIdVar, idHiddenDate2);
 			crearHiddenB('chequeCuit', chequeCuitIdVar, idHiddenDate2);
 			crearHiddenB('chequeFechaDeposito', chequeFechaIdVar, idHiddenDate2);
 			
 			//sumo el monto de cada cada cheque agregado
 			sumarMontos("#chequeMontoTotalId", chequeImporteIdVar)
 			
 			//sumo el monto total del recibo
 			calcularMontoTotalRecibo();
 			calcularBalance();
		});
		
		$('#descuentoBtnAgregarId').click(function(){
			var idHiddenDate=new Date();
			var idHiddenDate2 = idHiddenDate.getTime().toString();
			
			if($('#facturasMontoTotal').val() == ''){
				alert("Antes de ingresar un descuento, debe seleccionar la factura.");
				$('#facturasMontoTotal').focus();
				return;
			}
			
			if(!validaIntegridad_Descuento()){return;}
			
			var descuentoPorcentajeVar = $('#descuentoPorcentajeId').val();
			var descuentoDescripcionVar = $('#descuentoDescripcionId').val();
			
			var newRecord = '<tr><td>' + descuentoDescripcionVar + '</td>';
			newRecord = newRecord + '<td class="porcentajeDescuento">' + descuentoPorcentajeVar + '</td>';
			newRecord = newRecord + '<td class="idParaHidden" style="display: none;">' + idHiddenDate2 + '</td>';
			newRecord = newRecord + '<td><button type="button" class="btn btn-default" aria-label="Left Align" onclick="eliminarHidden(this)"/></button></td></tr>';
			
			$('#descuentoTableId tr:last').after(newRecord);
			
			crearHiddenB('descuentoPorcentaje', descuentoPorcentajeVar, idHiddenDate2);
			crearHiddenB('descuentoDescripcion', descuentoDescripcionVar, idHiddenDate2);
			
 			//sumo el porcentaje de cada descuento
 			//sumarMontos("#reciboTotalDescuento", descuentoPorcentajeVar); lo saque el 19/04
 			sumarMontos("#importeTotalDescuento", descuentoPorcentajeVar);
 			//calcularImporte_Descuento(); lo saque el 19/04
 			calcularBalance();
		});
		
		$('#idGuardarRecibo').click(function(){
			
			if (!validaIntegridadDeDatos()){return;}
			
			calcularMontoTotalRecibo();
			//calcularImporte_Descuento();
			calcularBalance();
			
			//if($('#balance').val() != '0' && $('#balance').val() != '0.00'){
			if(parseFloat($('#balance').val()) > 0){
				document.getElementById('textModal').innerHTML = '- El balance del recibo debe ser cero ó menor para poder procesar el mismo.';
				errObject = '#balance';
				$('#modalMensajes').modal();
				return;
			}
			
			var reciboId = $('#IdRecibo').val();
			var reciboNumero = $('#nroRecibo').val();
			var reciboClienteId = $('#clienteId').val(); //1;//Tomar el cliente id
			var reciboFecha = $('#fechaRecibo').val();
			var reciboImporteSumaFacturas = $('#facturasMontoTotal').val(); //$('#idFacturasMontoTotal').val();
			var reciboImporteTotal = $('#montoTotalRecibo').val();
			var reciboObservaciones = $('#idObservaciones').val();
			var reciboUsuario = $('#idObservaciones').val();
			var reciboFechaProceso = $('#fechaRecibo').val(); //"23/12/2015"; //$('#idObservaciones').val();
			var reciboTotalDescuento = $('#importeTotalDescuento').val(); // $('#reciboTotalDescuento').val();
			
			var efectivoImporte = $('#efectivoImporte').val();
			
		/*	var retencionNumero = $('#retencionNumero').val();
			var retencionImporte  = $('#retencionImporte').val();
			var retencionSucursal = $('#retencionSucursal').val();
			var retencionYear = $('#retencionYear').val(); */
			
			if($('#facturasMontoTotal').val() == 0.00 || $('#facturasMontoTotal').val() == '' || $('#facturasMontoTotal').val() == '0.00'){			
				reciboImporteSumaFacturas = '0';
 			}
			
			//creo hidden y lo adiciono al form
			/*console.log("A:"+reciboNumero);
			console.log("B:"+reciboClienteId);
			console.log("C:"+reciboFecha);
			console.log("D:"+reciboImporteSumaFacturas);
			console.log("E:"+reciboImporteTotal);
			console.log("F:"+reciboObservaciones);
			console.log("G:"+reciboUsuario);
			console.log("H:"+reciboFechaProceso);*/
			
			console.log("D:"+reciboImporteSumaFacturas);
			
			crearHidden('reciboId', reciboId);
			crearHidden('reciboNumero', reciboNumero);
			crearHidden('reciboClienteId', reciboClienteId);
			crearHidden('reciboFecha', reciboFecha);
			crearHidden('reciboImporteSumaFacturas', reciboImporteSumaFacturas);
			crearHidden('reciboImporteTotal', reciboImporteTotal);
			crearHidden('reciboObservaciones', reciboObservaciones);
			crearHidden('reciboUsuario', reciboUsuario);
			crearHidden('reciboFechaProceso', reciboFechaProceso);
			crearHidden('reciboTotalDescuento', reciboTotalDescuento);
			
			if(efectivoImporte > 0){
				crearHidden('efectivoImporte', efectivoImporte);
			}
			
		/*	if(retencionNumero != ''){
				crearHidden('retencionNumero', retencionNumero);
				crearHidden('retencionImporte', retencionImporte);
				crearHidden('retencionSucursal', retencionSucursal);
				crearHidden('retencionYear', retencionYear);
			} */
			
			//************ START AJAX			
		/*	var reciboId = $('#IdRecibo').val();
			$.ajax({
				url : '/recibo/modificar',
				data : 'reciboId=' + reciboId,
				type : 'GET',
				dataType : 'html',
				success : function(data) {
					//$('#contenido').html(data);
		 			//$("#modal_recibos").modal('toggle');
				},
				error : function() {
					// Aqui código cuando servidor retorna error
				},
			});*/
			//************ FIN AJAX
			$('#reciboFormId').submit();
		});
		
		$("#efectivoImporte").change(function(){
			
			$("#efectivoImporteRES").val($("#efectivoImporte").val());
			calcularMontoTotalRecibo();
			calcularBalance();			
		});
		
		
		$("#retencionImporte").change(function(){
			
			$("#retencionImporteRES").val($("#retencionImporte").val());
			calcularMontoTotalRecibo();
			calcularBalance();		
		});		
		
		/*$('#reciboFormId').validate({
			rules: {
					nroRecibo: {
						required: true,
						number: true
				 	}
					//nroRecibo: "required"
			},
			messages:{
					//nroRecibo: "campo obligatorio",
					nroRecibo: {
						required: "campo obligatorio",
						number: "Solo numeros"
				 	}
			}
		}); */
		
	}); //END ready(function()
	
	selectRow = function(aThis) {
		var tdArray = $(aThis).find("td");

		var clienteId = tdArray[0].innerHTML;
		var clienteNumero = tdArray[1].innerHTML;
		var clienteNombre = tdArray[2].innerHTML;
		$("#modal_cliente").modal('hide'); //.modal('toggle');
		
		$("#clienteNro").val(clienteNumero);
		$("#clienteNombre").val(clienteNombre);
		$("#clienteId").val(clienteId);
		
		ajaxExecuted = false;
	};
	
	
	crearHidden = function(nameVar, valueVar){
		var tempHidden = $('<input>').attr({
			type: 'hidden',
			name: nameVar, 
			value: valueVar
		});
		
		$('#reciboFormId').append(tempHidden);
	};
	
	crearHiddenB = function(nameVar, valueVar, id){
		//elimino los '.' y los espacios en blanco para el ID del Hidden
		var AuxId = id;
		AuxId = AuxId.split(' ').join('');
		AuxId = AuxId.split('.').join('');
		AuxId = AuxId.split(',').join('');
		AuxId = AuxId.split('/').join('');
		
		var tempHidden = $('<input>').attr({
			'type': 'hidden',
			'name': nameVar, 
			'value': valueVar,
			'class':AuxId
		});
		
		$('#reciboFormId').append(tempHidden);
	};
	
	//**** este evento se ejecuta automaticamente cuando se cierra la vtna modal *****
	$('#modalMensajes').on('hidden.bs.modal', function (e) {
		$(errObject).focus();
	});
	
	function validaIntegridadDeDatos(){
				
		if($('#nroRecibo').val() == ''|| $('#nroRecibo').val() == null){
			document.getElementById('textModal').innerHTML = '- Ingrese el Nº de Recibo.';
			$('#modalMensajes').modal();
			errObject = '#nroRecibo';
			return false;
		}
		
		if(isNaN($('#nroRecibo').val())){
			document.getElementById('textModal').innerHTML = '- El Nº de Recibo debe ser numérico.';
			errObject = '#nroRecibo';
			$('#modalMensajes').modal();			
			return false;
		}
		
		if($('#fechaRecibo').val() == ''){
			document.getElementById('textModal').innerHTML = '- Ingrese la fecha del Recibo.';
			errObject = '#fechaRecibo';
			$('#modalMensajes').modal();			
			return false;
		}
		
		if($("#clienteNro").val() == ''){
			$("#modal_cliente").modal();
			return false;
		}
		
		/*if($("#facturasMontoTotal").val() == ''){
			$("#modal_factura").modal();
			return false;
		} no hace falta ingresar una factura*/
		
		if(($('#retencionNumero').val() == '' || $('#retencionNumero').val() == 0) && ($('#efectivoImporte').val() == 0 || $('#efectivoImporte').val() == '') && ($('#chequeMontoTotalId').val() == '' || $('#chequeMontoTotalId').val() == 0.00) && ($('#depositoMontoTotal').val() == '' || $('#depositoMontoTotal').val() == 0.00)){
			document.getElementById('textModal').innerHTML = '- Debe ingresar al menos un tipo de pago.';
			$('#modalMensajes').modal();
			return false;
		}

		return true;
	};
	
	function validaIntegridad_DeCheque(){
		
		if($('#chequeBancoID').val() == '-------'){
			document.getElementById('textModal').innerHTML = '- Seleccione el banco.';
			errObject = '#chequeBancoID';
			$('#modalMensajes').modal();
			return false;
		}
		
		if($('#chequeNroId').val() == ''){
			document.getElementById('textModal').innerHTML = '- Ingrese el número de Cheque.';
			errObject = '#chequeNroId';
			$('#modalMensajes').modal();
			return false;
		}
		if(isNaN($('#chequeNroId').val())){
			document.getElementById('textModal').innerHTML = '- El nro. de cheque debe ser numérico.';
			errObject = '#chequeNroId';
			$('#modalMensajes').modal();			
			return false;
		}
		
		
		if($('#chequeImporte').val() == ''){
			document.getElementById('textModal').innerHTML = '- Ingrese el importe del cheque.';
			errObject = '#chequeImporte';
			$('#modalMensajes').modal();
			return false;
		}	
		if(isNaN($('#chequeImporte').val())){
			document.getElementById('textModal').innerHTML = '- El importe del cheque debe ser numérico.';
			errObject = '#chequeImporte';
			$('#modalMensajes').modal();			
			return false;
		}
		
		if($('#chequeCuitId').val() == ''){
			document.getElementById('textModal').innerHTML = '- Ingrese el Nº de CUIT.';
			errObject = '#chequeCuitId';
			$('#modalMensajes').modal();
			return false;
		}
		
		if($('#chequeFechaId').val() == ''){
			document.getElementById('textModal').innerHTML = '- Ingrese la fecha del Cheque.';
			errObject = '#chequeFechaId';
			$('#modalMensajes').modal();
			return false;
		}
		
		return true;
	};
	
	
	function validaIntegridad_Retencion(){
		
		if($('#retencionTipoPago').val() == '-------'){
			document.getElementById('textModal').innerHTML = '- Seleccione tipo de pago.';
			errObject = '#retencionTipoPago';
			$('#modalMensajes').modal();
			return false;
		}
		
		if($('#retencionNumero').val() == ''){
			document.getElementById('textModal').innerHTML = '- Indique el número de retención.';
			errObject = '#retencionNumero';
			$('#modalMensajes').modal();
			return false;
		}
		
		if($('#retencionImporte').val() == ''){
			document.getElementById('textModal').innerHTML = '- Indique el importe.';
			errObject = '#retencionImporte';
			$('#modalMensajes').modal();
			return false;
		}
		
		if($('#retencionSucursal').val() == ''){
			document.getElementById('textModal').innerHTML = '- Indique la sucursal.';
			errObject = '#retencionSucursal';
			$('#modalMensajes').modal();
			return false;
		}
		
		if($('#retencionYear').val() == ''){
			document.getElementById('textModal').innerHTML = '- Indique el año.';
			errObject = '#retencionYear';
			$('#modalMensajes').modal();
			return false;
		}
		
		return true;
	}
	
	
	function validaIntegridad_Deposito(){
		
		if($('#depositoBancoId').val() == '-------'){
			document.getElementById('textModal').innerHTML = '- Seleccione el banco.';
			errObject = '#depositoBancoId';
			$('#modalMensajes').modal();
			return false;
		}
		
		if($('#depositoImporteId').val() == ''){
			document.getElementById('textModal').innerHTML = '- Indique el importe del deposito.';
			errObject = '#depositoImporteId';
			$('#modalMensajes').modal();
			return false;
		}
		if(isNaN($('#depositoImporteId').val())){
			document.getElementById('textModal').innerHTML = '- El importe del deposito debe ser numérico.';
			errObject = '#depositoImporteId';
			$('#modalMensajes').modal();			
			return false;
		}
		
		if($('#depositoFechaId').val() == ''){
			document.getElementById('textModal').innerHTML = '- Indique la fecha del deposito.';
			errObject = '#depositoFechaId';
			$('#modalMensajes').modal();
			return false;
		}		
		
		return true;
	};
	
	function validaIntegridad_Descuento(){
		if($('#descuentoDescripcionId').val() == ''){
			document.getElementById('textModal').innerHTML = '- Indique la descripción del desuento.';
			errObject = '#descuentoDescripcionId';
			$('#modalMensajes').modal();
			return false;
		}	
		
		if($('#descuentoPorcentajeId').val() == ''){
			document.getElementById('textModal').innerHTML = '- Indique el monto del descuento.';
			errObject = '#descuentoPorcentajeId';
			$('#modalMensajes').modal();
			return false;
		}
		if(isNaN($('#descuentoPorcentajeId').val())){
			document.getElementById('textModal').innerHTML = '- El monto del descuento debe ser numérico.';
			errObject = '#descuentoPorcentajeId';
			$('#modalMensajes').modal();			
			return false;
		}
				
		return true;
	};
	
	function calcularMontoTotalRecibo(){
		var monto=0;
		var chequeImporteTotal = $("#chequeMontoTotalId").val();
		var efectivoMonto = $("#efectivoImporte").val();
		var depositoImporteTotal = $("#depositoMontoTotal").val();
		//var retencionImporte = $("#retencionImporte").val();
		var retencionImporte = $("#retencionMontoTotal").val();
		
		
		if(chequeImporteTotal == ''){chequeImporteTotal = 0}
		if(efectivoMonto == ''){efectivoMonto = 0}
		if(depositoImporteTotal == ''){depositoImporteTotal = 0}
		if(retencionImporte == ''){retencionImporte = 0}
		
		//$("#montoTotalRecibo").val(parseFloat(chequeImporteTotal) + parseFloat(efectivoMonto) + parseFloat(depositoImporteTotal) + parseFloat(retencionImporte));
		monto = parseFloat(chequeImporteTotal) + parseFloat(efectivoMonto) + parseFloat(depositoImporteTotal) + parseFloat(retencionImporte);
		$("#montoTotalRecibo").val(monto.toFixed(2));
	};
	
	/*function calcularImporte_Descuento(){
		var monto=0;
		var facturasMontoTotal = $('#facturasMontoTotal').val();
		var reciboTotalDescuento = $('#reciboTotalDescuento').val();
		
		if(facturasMontoTotal == '' || reciboTotalDescuento == ''){
			return;
		}
		
		//$('#importeTotalDescuento').val(parseFloat($('#facturasMontoTotal').val()) / parseFloat(100) * parseFloat($('#reciboTotalDescuento').val()));
		monto = parseFloat($('#facturasMontoTotal').val()) / parseFloat(100) * parseFloat($('#reciboTotalDescuento').val());
		$('#importeTotalDescuento').val(monto.toFixed(2));
	};*/
	
	function calcularBalance(){
		var monto=0;
		var importeTotalDescuento = $('#importeTotalDescuento').val();
		
		if(importeTotalDescuento == ''){importeTotalDescuento = 0;}
		
		if($('#facturasMontoTotal').val() != '' && $('#facturasMontoTotal').val() != '0.00'){
			//$('#balance').val(parseFloat($('#facturasMontoTotal').val()) - (parseFloat($('#montoTotalRecibo').val()) + parseFloat(importeTotalDescuento)));
			monto = parseFloat($('#facturasMontoTotal').val()) - (parseFloat($('#montoTotalRecibo').val()) + parseFloat(importeTotalDescuento));
			$('#balance').val(monto.toFixed(2));
		}
		else{
			monto = (0 - parseFloat($('#montoTotalRecibo').val()) + parseFloat(importeTotalDescuento));
			$('#balance').val(monto.toFixed(2));
		}
	}
	
	function sumarMontos(inputName, montoParcial){
		var monto =0;
		if($(inputName).val() == ''){
	 			$(inputName).val(montoParcial);
		}
		else{
			//$(inputName).val(parseFloat($(inputName).val()) + parseFloat(montoParcial));
			monto = parseFloat($(inputName).val()) + parseFloat(montoParcial);
			$(inputName).val(monto.toFixed(2));
		}
		
		if(inputName != "#facturasMontoTotal"){
			$(inputName + 'RES').val($(inputName).val());
		}
	};
	
	function eliminarHidden (botonEliminar) {	
		
		var elementoTR = $(botonEliminar).closest('tr');
		var idHidden = $(elementoTR).find('.idParaHidden').text();		
		
		var montoDescAux = '';
		var montoFactura = '';
		var montoCheque = '';
		var montoDeposito = '';
		var montoRetencion= '';
		var porcentajeDescuento = '';
		
		montoFactura = $(elementoTR).find('.montoFac').text();
		montoCheque = $(elementoTR).find('.montoCheque').text();
		montoDeposito = $(elementoTR).find('.montoDeposito').text();
		montoRetencion = $(elementoTR).find('.montoRetencion').text();
		porcentajeDescuento = $(elementoTR).find('.porcentajeDescuento').text();		
		
		//new
			/*alert(montoFactura);
			alert(montoCheque);
			alert(montoDeposito);
			alert(porcentajeDescuento);*/
			
		/*	alert($(this).text);
			if($(elementoTR).hasClass('montoFac')) {
   				alert('Este link tiene la clase "montoFac".');
  			}*/
		//end new
		var monto =0;
		if(montoFactura != ''){
			monto = parseFloat($('#facturasMontoTotal').val()) - parseFloat(montoFactura);
			$('#facturasMontoTotal').val(monto.toFixed(2));
		}else{
			if(montoCheque != ''){
				monto = parseFloat($('#chequeMontoTotalId').val()) - parseFloat(montoCheque);
				$('#chequeMontoTotalId').val(monto.toFixed(2));
				$('#chequeMontoTotalIdRES').val($('#chequeMontoTotalId').val());
			}
			else{
				if(montoDeposito != ''){					
					monto = parseFloat($('#depositoMontoTotal').val()) - parseFloat(montoDeposito);
					$('#depositoMontoTotal').val(monto.toFixed(2));
					$('#depositoMontoTotalRES').val($('#depositoMontoTotal').val());
				}else{				
					if(montoRetencion != ''){
						monto = parseFloat($('#retencionMontoTotal').val()) - parseFloat(montoRetencion);
						$('#retencionMontoTotal').val(monto.toFixed(2));
						$('#retencionMontoTotalRES').val($('#retencionMontoTotal').val());
					}else{
					//monto = parseFloat($('#reciboTotalDescuento').val()) - parseFloat(porcentajeDescuento);
					//$('#reciboTotalDescuento').val(monto.toFixed(2));
					
					//monto = parseFloat($('#facturasMontoTotal').val()) / parseFloat(100) * parseFloat(porcentajeDescuento);
					montoDescAux = parseFloat($('#importeTotalDescuento').val()) - parseFloat(porcentajeDescuento); //parseFloat(monto);
					$('#importeTotalDescuento').val(montoDescAux.toFixed(2));
					$('#importeTotalDescuentoRES').val($('#importeTotalDescuento').val());
					}
				}
			}
		}
		
		calcularMontoTotalRecibo();
		//calcularImporte_Descuento();
 		calcularBalance();
		
		//le saco los ' ' los '.' y las ',' al texto para igualarlo con el id del hidden
		idHidden = idHidden.split(' ').join('');
		idHidden = idHidden.split('.').join('');
		idHidden = idHidden.split(',').join('');
		idHidden = idHidden.split('/').join('');
		
		$('.' + idHidden).remove();
		elementoTR.remove();
		
		// Enable factura of facturaTblModal, page ccSlectedCustomer.html
		var facturaNro = $(elementoTR).find('.facturaNro').text();
		$("#facturaTblModal").find('.hidden-td-' + facturaNro).text('enable');
		$("#facturaTblModal").find('.hidden-td-' + facturaNro).closest('tr').removeProp('style');
	};
	
	function eliminarSoloHidden (botonEliminar) {	
		var elementoTR = $(botonEliminar).closest('tr');
		var idHidden = $(elementoTR).find('.idParaHidden').text();		
			
		$('.' + idHidden).remove();
	};
	// -------------------------------------------------------------------------------------------
	// Funcion para editar facturas
	var valorAnt;
	var editingValue = false;
	function editarMontoFactura(editBtn) {
		
		var editBtnClass = $(editBtn).attr('class');
		
		// No permitir editar 2 valores al mismo tiempo, 
		// porque el código no está preparado para eso.
		if(editBtnClass == 'btn btn-success' && editingValue) {
			return;
		}
		
		if(editBtnClass == 'btn btn-success') {
			
			$(editBtn).removeClass('btn btn-success');
			$(editBtn).addClass('btn btn-warning');
			
			// Hide eliminar buttons
			$('#tblFactura tr').each(function() {
				$(this).find('.btn-danger').parent('td').hide();
			});
			
			var elementoTR = $(editBtn).closest('tr');
			var montoFactura = $(elementoTR).find('.montoFac').text();
			$(elementoTR).find('.montoFac').html('<input type="text" class="montoFacInp" onkeypress="return saveOnKeyPress(event)" style="color: black;" value="' + montoFactura + '"/>');
			valorAnt = montoFactura;
			editingValue = true;
			
		} else {
			
			$(editBtn).removeClass('btn btn-warning');
			$(editBtn).addClass('btn btn-success');
			
			// Show eliminar buttons
			$('#tblFactura tr').each(function() {
				$(this).find('.btn-danger').parent('td').show();
			});
			
			var elementoTR = $(editBtn).closest('tr');
			var montoFactura = $(elementoTR).find('.montoFacInp').val();
			$(elementoTR).find('.montoFac').html(montoFactura);
			
			atualizarMontoTotalFactura(valorAnt, montoFactura);
			editingValue = false;
			
			//elimino y vuelvo a crear el hidden
			var facNumero = $(elementoTR).find('.facturaNro').text();
			var facFech = $(elementoTR).find('.facturaFecha').text();
			var idHiddenDate3 = $(elementoTR).find('.idParaHidden').text();
			
			eliminarSoloHidden(editBtn);
			
			crearHiddenB('facturaNro', facNumero, idHiddenDate3);
 			crearHiddenB('facturaFecha', facFech, idHiddenDate3);
 			crearHiddenB('facturaMonto', montoFactura, idHiddenDate3);
 			//FIN //elimino y vuelvo a crear el hidden
	        calcularMontoTotalRecibo();
			calcularBalance();
		}
	};
	
	function atualizarMontoTotalFactura(valorAnt, valorNuevo) {
		var valorTotal = parseFloat($('#facturasMontoTotal').val());
		valorTotal = valorTotal - parseFloat(valorAnt);
		valorTotal = valorTotal + parseFloat(valorNuevo);
		$('#facturasMontoTotal').val(valorTotal.toFixed(2));
	};
	
	function saveOnKeyPress(e) {
	    if(e.keyCode == 13) {
	        editarMontoFactura($('#tblFactura .btn-warning'));
	    }
	};
</script>

</html>